// LogiD configuration file snippet for Logitech MX Master 3S
// Put this in /etc/logid.cfg (or merge into your existing file)
// LogiD reads this to define per-device behavior and remaps.

// "devices" is a list of device profiles LogiD should apply.
devices: (
  {
    // Match the device by its reported name.
    // Run `sudo logid -v` (or check logs) if you need to confirm the exact name.
    name: "MX Master 3S For Mac";

    // SmartShift controls the scroll wheel mode:
    // - "on: true" enables automatic switching between smooth (free-spin) and ratchet.
    // - "threshold" controls how easily it flips into free-spin (higher = harder to trigger).
    smartshift: { on: true; threshold: 13; };

    // Vertical scroll wheel Hi-Res scroll settings.
    // NOTE: Your comment says "Hi-Res OFF", but `hires: true` means Hi-Res is ON here.
    // If you truly want Hi-Res OFF, set `hires: false`.
    hiresscroll: {
      // Enables/disables high-resolution scrolling (smoother, more granular scroll events).
      hires: true;

      // Inverts vertical scrolling direction (like "natural scrolling" toggle).
      invert: true;

      // When true, hi-res scroll events can be redirected (diverted) for custom actions.
      // false means allow normal scrolling behavior to go to the OS/app.
      target: false;
    };

    // Mouse pointer sensitivity in DPI (dots per inch).
    // Higher = faster cursor movement.
    dpi: 1800;

    // Thumb wheel (horizontal wheel) configuration.
    // Many people map this to volume because itâ€™s very reliable.
    thumbwheel: {
      // "divert: true" tells LogiD to intercept the wheel events
      // instead of passing them as normal horizontal scroll to the OS.
      // This is REQUIRED if you want it to act like volume keys instead of scrolling sideways.
      divert: true;

      // Inverts the thumbwheel direction (swap left/right behavior).
      invert: false;

      // Action when you scroll the thumbwheel left.
      left: {
        // "OnInterval" repeats the action while the wheel is being scrolled/held in that direction.
        mode: "OnInterval";

        // Interval in "ticks" / time units used by LogiD for repeating actions.
        // Lower = repeats faster. 1 is usually the most responsive.
        interval: 1;

        // Emit a keypress event: Volume Down.
        action: { type: "Keypress"; keys: [ "KEY_VOLUMEDOWN" ]; };
      };

      // Action when you scroll the thumbwheel right.
      right: {
        mode: "OnInterval";
        interval: 1;

        // Emit a keypress event: Volume Up.
        action: { type: "Keypress"; keys: [ "KEY_VOLUMEUP" ]; };
      };
    };

    // Button remaps list.
    // Each entry maps a "cid" (control/button ID) to an action.
    buttons: (
      // ------------------------------------------------------------
      // Gesture Button (press-and-hold button, then move mouse)
      // ------------------------------------------------------------
      { cid: 0xc3; action = {
        // Define this button as a gesture controller.
        type: "Gestures";

        // List of gesture directions and what happens for each.
        gestures: (
          // "None" = you pressed and released without moving (a normal click / press).
          // "OnRelease" = the action triggers when you let go of the button.
          // Action: Super (Meta) + D => show desktop (GNOME default).
          { direction: "None"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTMETA", "KEY_D"]; };
          },

          // Move mouse to the right while holding the gesture button.
          // Action: Shift + F8 (commonly mapped by apps to "next" / "forward" / custom hotkey).
          { direction: "Right"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTSHIFT", "KEY_F8"]; };
          },

          // Move mouse to the left while holding the gesture button.
          // Action: Shift + F7 (commonly mapped to "previous" / "back" / custom hotkey).
          { direction: "Left"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTSHIFT", "KEY_F7"]; };
          },

          // Move mouse up while holding the gesture button.
          // Action: Ctrl + Alt + T => open terminal (GNOME common shortcut).
          { direction: "Up"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTCTRL", "KEY_LEFTALT", "KEY_T"]; };
          },

          // Move mouse down while holding the gesture button.
          // Action: Ctrl + Alt + C => custom shortcut (depends on what you assigned in GNOME/app).
          { direction: "Down"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTCTRL", "KEY_LEFTALT", "KEY_C"]; };
          }
        );
      }; },

      // ------------------------------------------------------------
      // Top button (the small button near the scroll wheel) as gestures
      // ------------------------------------------------------------
      { cid: 0xc4; action = {
        type: "Gestures";

        gestures: (
          // Normal press/release without moving:
          // Toggle SmartShift on/off (switch between auto and fixed scroll mode).
          // { direction: "None"; mode: "OnRelease"; action = { type: "ToggleSmartShift"; }; },
          { direction: "None"; mode: "OnRelease"; action = { type: "Keypress"; keys: ["KEY_SYSRQ"]; }; },

          // Move mouse up while holding top button:
          // Ctrl + Tab => next tab (browser/editor standard shortcut).
          { direction: "Up"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTCTRL", "KEY_TAB"]; };
          },

          // Move mouse down while holding top button:
          // Ctrl + Shift + Tab => previous tab.
          { direction: "Down"; mode: "OnRelease";
            action = { type: "Keypress"; keys: ["KEY_LEFTCTRL", "KEY_LEFTSHIFT", "KEY_TAB"]; };
          }
        );
      }; }
    );
  }
);
